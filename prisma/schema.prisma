generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model admin {
  admin_id   Int       @id @default(autoincrement())
  username   String    @unique @db.VarChar(50)
  password   String    @db.VarChar(100)
  roles      String[]
  email      String?   @db.VarChar(100)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @db.Timestamp(6)
}

model credit {
  credit_id              Int                 @id @default(autoincrement())
  customer_id            Int?                @unique
  due_date               DateTime?           @db.Date
  credit_amount          Int?
  status                 credit_status_enum?
  total_credit_limit     Int?
  available_credit_limit Int?
  created_at             DateTime?           @db.Timestamp(6)
  updated_at             DateTime?           @db.Timestamp(6)
  customer               customer?           @relation(fields: [customer_id], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
}

model customer {
  customer_id      Int            @id @default(autoincrement())
  username         String         @unique @db.VarChar(50)
  password         String         @db.VarChar(100)
  email            String         @unique @db.VarChar(100)
  mobile_number    String         @unique @db.VarChar(15)
  credit_limit     Decimal?       @db.Decimal(12, 2)
  remaining_credit Decimal?       @db.Decimal(12, 2)
  created_at       DateTime?      @default(now()) @db.Timestamp(6)
  updated_at       DateTime?      @db.Timestamp(6)
  cartItem         cartItem[]
  credit           credit?
  notification     notification[]
  order            order[]
  quotation        quotation[]
}

model inventory_inflow_outflow {
  id             Int                  @id @default(autoincrement())
  product_id     Int?
  flow_direction flow_direction_enum?
  quantity       Int?
  created_at     DateTime?            @default(now()) @db.Timestamp(6)
  product        product?             @relation(fields: [product_id], references: [product_id], onDelete: NoAction, onUpdate: NoAction)
}

model notification {
  notification_id Int       @id @default(autoincrement())
  customer_id     Int?
  message         String
  sent_at         DateTime? @default(now()) @db.Timestamp(6)
  customer        customer? @relation(fields: [customer_id], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
}

model order {
  order_id      Int                @id @default(autoincrement())
  quotation_id  Int?
  customer_id   Int?
  status        order_status_enum? @default(pending)
  total_price   Decimal?           @db.Decimal(12, 2)
  created_at    DateTime?          @default(now()) @db.Timestamp(6)
  updated_at    DateTime?          @db.Timestamp(6)
  customer      customer?          @relation(fields: [customer_id], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
  quotation     quotation?         @relation(fields: [quotation_id], references: [quotation_id], onDelete: NoAction, onUpdate: NoAction)
  order_details order_details[]
  payment       payment[]
}

model order_details {
  order_item_id Int      @id @default(autoincrement())
  order_id      Int?
  product_id    Int?
  quantity      Int
  price         Decimal  @db.Decimal(10, 2)
  order         order?   @relation(fields: [order_id], references: [order_id], onDelete: NoAction, onUpdate: NoAction)
  product       product? @relation(fields: [product_id], references: [product_id], onDelete: NoAction, onUpdate: NoAction)
}

model payment {
  payment_id   Int                  @id @default(autoincrement())
  order_id     Int?
  amount       Decimal              @db.Decimal(12, 2)
  payment_mode payment_mode_enum?
  payment_date DateTime?            @default(now()) @db.Timestamp(6)
  status       payment_status_enum? @default(pending)
  order        order?               @relation(fields: [order_id], references: [order_id], onDelete: NoAction, onUpdate: NoAction)
}

model product {
  product_id               Int                        @id @default(autoincrement())
  name                     String                     @db.VarChar(100)
  min_stock_limit          Int?                       @default(10)
  description              String?
  specifications           String?
  image_url                String[]
  price                    Decimal                    @db.Decimal(10, 2)
  created_at               DateTime?                  @default(now()) @db.Timestamp(6)
  updated_at               DateTime?                  @db.Timestamp(6)
  category                 String?
  brand                    String?
  cartItem                 cartItem[]
  inventory_inflow_outflow inventory_inflow_outflow[]
  order_details            order_details[]
  quotation_details        quotation_details[]
}

model quotation {
  quotation_id      Int                    @id @default(autoincrement())
  customer_id       Int?
  admin_id          Int?
  status            quotation_status_enum? @default(draft)
  total_amount      Decimal?               @db.Decimal(12, 2)
  credit_period     Int?
  payment_mode      payment_mode_enum?
  created_at        DateTime?              @default(now()) @db.Timestamp(6)
  updated_at        DateTime?              @db.Timestamp(6)
  order             order[]
  customer          customer?              @relation(fields: [customer_id], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
  quotation_details quotation_details[]
}

model quotation_details {
  quotation_item_id Int        @id @default(autoincrement())
  quotation_id      Int?
  product_id        Int?
  quantity          Int
  price             Decimal?   @db.Decimal(10, 2)
  product           product?   @relation(fields: [product_id], references: [product_id], onDelete: NoAction, onUpdate: NoAction)
  quotation         quotation? @relation(fields: [quotation_id], references: [quotation_id], onDelete: NoAction, onUpdate: NoAction)
}

model cartItem {
  id        Int      @id @default(autoincrement())
  userId    Int
  productId Int
  quantity  Int
  product   product  @relation(fields: [productId], references: [product_id], onDelete: NoAction, onUpdate: NoAction)
  Customer  customer @relation(fields: [userId], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
}

enum credit_status_enum {
  receivable
  received
}

enum flow_direction_enum {
  in
  out
}

enum order_status_enum {
  pending
  confirmed
  cancelled
  completed
}

enum payment_mode_enum {
  credit
  cash
  upi
  card
  cheque
}

enum payment_status_enum {
  pending
  completed
  failed
}

enum quotation_status_enum {
  draft
  sent
  approved
  rejected
}
